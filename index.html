<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>recorder</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style type="text/css">
  button{
    width: 100px;
    border-radius: 50px;
    padding:10px;
    display: inline-block;
    float: none;
    clear: both;
    font-weight: bold;
    font-size: 12px;
  }
  audio{
    display: block;
    margin:10px 0;
  }
  .container{
    margin:0 auto;
    width:350px;
    background: #ddd;
    padding: 10px;
  }
  </style>
  <script src="script.js"></script>
</head>
<body>
<div class="container">
    <fieldset>
      <legend>Record audio</legend> 
      <audio id="player" controls></audio>
      <p id="timer"></p>
      <button id="mic" onclick="start()">Start</button>
      <button id="playbtn" onclick="play()">play</button>
      <button onclick="window.location.reload()">reload</button>
    </fieldset>
</div>
<script>
    var audioTrack = new WebAudioTrack();
    var player = document.getElementById('player');
    var timer = document.getElementById('timer');
    var playbtn = document.getElementById('playbtn');
    var blob = document.getElementById('blob');
    var recorded_data = '';

    function start(){
      console.log('start()');
      var mic = document.getElementById('mic');
      var att = document.createAttribute('onclick');
      att.value = 'stop()';
      mic.innerHTML = 'Stop';
      mic.style.backgroundColor = 'red';
      mic.style.color = 'white';
      mic.setAttributeNode(att);
      audioTrack.startRecording(function() {
        timer.innerHTML = getRecordingTime();
      });
    }
    function stop(){
      console.log('stop()');
      var mic = document.getElementById('mic');
      var att = document.createAttribute('onclick');
      att.value = 'start()';
      mic.setAttributeNode(att);
      mic.innerHTML = 'Start';
      mic.style.backgroundColor = 'white';
      playbtn.style.backgroundColor = '#30c3ff';
      playbtn.style.color = 'white';
      mic.style.color = 'black';
      audioTrack.stopRecording(function() {});
      
    }
    function play(){
      player.src = audioTrack.getBlobSrc();
      player.play();
    }
</script>
</body>
</html>